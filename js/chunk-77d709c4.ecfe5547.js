(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-77d709c4"],{"1af6":function(t,e,n){var i=n("63b6");i(i.S,"Array",{isArray:n("9003")})},"20fd":function(t,e,n){"use strict";var i=n("d9f6"),r=n("aebd");t.exports=function(t,e,n){e in t?i.f(t,e,r(0,n)):t[e]=n}},"28a5":function(t,e,n){"use strict";var i=n("aae3"),r=n("cb7c"),a=n("ebd6"),s=n("0390"),o=n("9def"),c=n("5f1b"),u=n("520a"),l=n("79e5"),f=Math.min,p=[].push,d="split",h="length",m="lastIndex",v=4294967295,g=!l(function(){RegExp(v,"y")});n("214f")("split",2,function(t,e,n,l){var b;return b="c"=="abbc"[d](/(b)*/)[1]||4!="test"[d](/(?:)/,-1)[h]||2!="ab"[d](/(?:ab)*/)[h]||4!="."[d](/(.?)(.?)/)[h]||"."[d](/()()/)[h]>1||""[d](/.?/)[h]?function(t,e){var r=String(this);if(void 0===t&&0===e)return[];if(!i(t))return n.call(r,t,e);var a,s,o,c=[],l=(t.ignoreCase?"i":"")+(t.multiline?"m":"")+(t.unicode?"u":"")+(t.sticky?"y":""),f=0,d=void 0===e?v:e>>>0,g=new RegExp(t.source,l+"g");while(a=u.call(g,r)){if(s=g[m],s>f&&(c.push(r.slice(f,a.index)),a[h]>1&&a.index<r[h]&&p.apply(c,a.slice(1)),o=a[0][h],f=s,c[h]>=d))break;g[m]===a.index&&g[m]++}return f===r[h]?!o&&g.test("")||c.push(""):c.push(r.slice(f)),c[h]>d?c.slice(0,d):c}:"0"[d](void 0,0)[h]?function(t,e){return void 0===t&&0===e?[]:n.call(this,t,e)}:n,[function(n,i){var r=t(this),a=void 0==n?void 0:n[e];return void 0!==a?a.call(n,r,i):b.call(String(r),n,i)},function(t,e){var i=l(b,t,this,e,b!==n);if(i.done)return i.value;var u=r(t),p=String(this),d=a(u,RegExp),h=u.unicode,m=(u.ignoreCase?"i":"")+(u.multiline?"m":"")+(u.unicode?"u":"")+(g?"y":"g"),w=new d(g?u:"^(?:"+u.source+")",m),y=void 0===e?v:e>>>0;if(0===y)return[];if(0===p.length)return null===c(w,p)?[p]:[];var x=0,C=0,I=[];while(C<p.length){w.lastIndex=g?C:0;var _,E=c(w,g?p:p.slice(C));if(null===E||(_=f(o(w.lastIndex+(g?0:C)),p.length))===x)C=s(p,C,h);else{if(I.push(p.slice(x,C)),I.length===y)return I;for(var A=1;A<=E.length-1;A++)if(I.push(E[A]),I.length===y)return I;C=x=_}}return I.push(p.slice(x)),I}]})},"337f":function(t,e,n){"use strict";n("3b2b"),n("a481"),n("7f7f"),n("28a5"),n("6b54"),n("5df3"),n("ac6a");var i=n("795b"),r=n.n(i),a=n("8aa5"),s=n.n(a);e["a"]={methods:{upload:function(t,e){var n=this;return new r.a(function(i,a){var s=[];t.forEach(function(t){s.push(n.uploadPicture(e,t.file))},n),r.a.all(s).then(function(t){i(t)}).catch(function(t){a(t)})})},uploadPicture:function(t,e){var n=s.a.storage().ref(),i="images/"+t+"/"+Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15)+"."+e.name.split(".").pop(),a=n.child(i);return new r.a(function(t,n){a.put(e).on("state_changed",function(){},function(t){console.log("upload picture error",t),n(t)},function(){a.getDownloadURL().then(function(e){t({path:i,src:e})})})})},slug:function(t){if(!t)return t;t=t.replace(/^\s+|\s+$/g,""),t=t.toLowerCase();for(var e="åàáãäâèéëêìíïîòóöôùúüûñç·/_,:;",n="aaaaaaeeeeiiiioooouuuunc------",i=0,r=e.length;i<r;i++)t=t.replace(new RegExp(e.charAt(i),"g"),n.charAt(i));return t=t.replace(/[^a-z0-9 -]/g,"").replace(/\s+/g,"-").replace(/-+/g,"-").replace(/^-+/,"").replace(/-+$/,""),t}}}},"3b2b":function(t,e,n){var i=n("7726"),r=n("5dbc"),a=n("86cc").f,s=n("9093").f,o=n("aae3"),c=n("0bfb"),u=i.RegExp,l=u,f=u.prototype,p=/a/g,d=/a/g,h=new u(p)!==p;if(n("9e1e")&&(!h||n("79e5")(function(){return d[n("2b4c")("match")]=!1,u(p)!=p||u(d)==d||"/a/i"!=u(p,"i")}))){u=function(t,e){var n=this instanceof u,i=o(t),a=void 0===e;return!n&&i&&t.constructor===u&&a?t:r(h?new l(i&&!a?t.source:t,e):l((i=t instanceof u)?t.source:t,i&&a?c.call(t):e),n?this:f,u)};for(var m=function(t){t in u||a(u,t,{configurable:!0,get:function(){return l[t]},set:function(e){l[t]=e}})},v=s(l),g=0;v.length>g;)m(v[g++]);f.constructor=u,u.prototype=f,n("2aba")(i,"RegExp",u)}n("7a56")("RegExp")},4047:function(t,e,n){"use strict";n.r(e);var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"bg-light hero is-fullheight"},[t.newItem?n("div",{staticClass:"hero-body"},[n("div",{staticClass:"container"},[n("div",{staticClass:"columns"},[n("div",{staticClass:"column is-8 is-offset-2"},[n("p",{staticClass:"title"},[t._v("You Are Editing an Item")]),n("form",{ref:"form",on:{submit:function(e){return e.preventDefault(),t.submit(e)}}},[n("div",{staticClass:"field"},[n("label",{staticClass:"label",attrs:{for:"name"}},[t._v("Name")]),n("div",{staticClass:"control"},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.newItem.name,expression:"newItem.name"}],ref:"inputName",staticClass:"input is-medium",attrs:{type:"text",id:"name",placeholder:"Vintage toaster",required:""},domProps:{value:t.newItem.name},on:{input:function(e){e.target.composing||t.$set(t.newItem,"name",e.target.value)}}})]),t.showNameError?n("p",{staticClass:"help is-danger"},[t._v("This name is already taken, please choose another or "),n("a",{attrs:{href:"#"},on:{click:function(e){e.preventDefault(),t.newItem.name=t.item.name}}},[t._v("change it back.")])]):t._e()]),n("div",{staticClass:"field"},[n("label",{staticClass:"label",attrs:{for:"description"}},[t._v("Description")]),n("div",{staticClass:"control"},[n("textarea",{directives:[{name:"model",rawName:"v-model",value:t.newItem.description,expression:"newItem.description"}],staticClass:"textarea is-medium",attrs:{id:"description",placeholder:"A super cute item that you really should buy."},domProps:{value:t.newItem.description},on:{input:function(e){e.target.composing||t.$set(t.newItem,"description",e.target.value)}}})]),n("p",[t._v("Optional. Short or as long as you want. Please use full sentences.")])]),n("div",{staticClass:"field"},[n("label",{staticClass:"label",attrs:{for:"price"}},[t._v("Price")]),n("div",{staticClass:"control"},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.newItem.price,expression:"newItem.price"}],staticClass:"input is-medium",attrs:{type:"number",pattern:"[0-9]+(\\.[0-9][0-9]?)?",step:"0.01",id:"price",placeholder:"100.00",required:""},domProps:{value:t.newItem.price},on:{input:function(e){e.target.composing||t.$set(t.newItem,"price",e.target.value)}}})]),n("p",[t._v("Do not include dollar sign.")])]),n("label",{staticClass:"label"},[t._v("Pictures")]),n("div",{staticClass:"pictures columns is-multiline is-vcentered"},t._l(t.newItem.pictures,function(e,i){return n("div",{key:i,staticClass:"picture column is-half-tablet"},[n("img",{attrs:{src:e.src}}),n("button",{staticClass:"button is-light is-warning is-fullwidth",attrs:{type:"button"},on:{click:function(e){return e.preventDefault(),t.deletePicture(i)}}},[t._v("Delete\n                                ")])])}),0),n("div",{staticClass:"file is-boxed"},[n("label",{staticClass:"file-label"},[n("input",{ref:"inputPicture",staticClass:"file-input",attrs:{type:"file",name:"picture",accept:"image/*",multiple:"",camera:""},on:{change:t.onPictureChange}}),n("span",{staticClass:"file-cta"},[n("span",{staticClass:"file-icon"},[n("font-awesome-icon",{attrs:{icon:"upload"}})],1),n("span",{staticClass:"file-label"},[t._v("\n                                        Choose a file…\n                                    ")])])])]),n("button",{staticClass:"button is-primary is-large is-fullwidth move-down",class:{"is-loading":t.isLoading},attrs:{type:"submit"}},[t._v("\n                            Save Changes\n                        ")]),n("button",{staticClass:"button is-danger is-large is-fullwidth move-down",attrs:{type:"button"},on:{click:t.onDelete}},[t._v("\n                            Delete This Item\n                        ")]),n("button",{staticClass:"button is-large is-fullwidth move-down",attrs:{type:"button"},on:{click:t.cancel}},[t._v("\n                            Cancel\n                        ")])])])])])]):t._e()])},r=[],a=n("75fc"),s=n("795b"),o=n.n(s),c=(n("5df3"),n("ac6a"),n("7f7f"),n("96cf"),n("3b8d")),u=n("f499"),l=n.n(u),f=n("8aa5"),p=n.n(f),d=n("17e1"),h=n("337f"),m=n("1940"),v=n.n(m),g={mixins:[h["a"]],data:function(){return{isLoading:!1,item:null,newItem:null,showNameError:!1,picsToUpload:[],picsToDelete:[]}},created:function(){var t=this;this.storage=p.a.storage().ref(),this.ref=d["a"].collection("items").doc(this.$route.params.id),this.$bind("item",this.ref).then(function(e){e?t.newItem=JSON.parse(l()(e)):t.$router.push("/404")})},methods:{deletePicture:function(t){this.picsToDelete.push(this.newItem.pictures[t]),this.newItem.pictures.splice(t,1)},submit:function(){var t=Object(c["a"])(regeneratorRuntime.mark(function t(){var e,n,i,r,a=this;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(this.isLoading=!0,this.showNameError=!1,this.newItem.name===this.item.name){t.next=9;break}return t.next=5,this.updateItemPath().catch(function(){return a.showNameError=!0,a.$refs.inputName.focus(),a.isLoading=!1,!1});case 5:if(e=t.sent,e){t.next=8;break}return t.abrupt("return");case 8:this.ref=e;case 9:if(n=this.slug(this.newItem.name),!(this.picsToDelete.length>0)){t.next=15;break}return i=[],this.picsToDelete.forEach(function(t){i.push(a.storage.child(t.path).delete())},this),t.next=15,o.a.all(i).catch(function(){});case 15:return r=[],this.newItem.pictures.forEach(function(t,e,i){t.file&&r.push(a.uploadPicture(n,t.file).then(function(t){i[e]=t}))}),t.next=19,o.a.all(r).catch(function(t){console.log("upload pics error",t)});case 19:this.ref.set(this.newItem),this.item=JSON.parse(l()(this.newItem)),window.history.replaceState({},"Shirley's Estate Sale","/edit/"+n),this.isLoading=!1,v()({title:"Item saved!",icon:"success"});case 24:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}(),onDelete:function(){var t=Object(c["a"])(regeneratorRuntime.mark(function t(){var e=this;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,v()("Are you sure?",{icon:"warning",buttons:!0,dangerMode:!0});case 2:if(t.sent){t.next=4;break}return t.abrupt("return");case 4:return t.next=6,new o.a(function(t,n){var i=[];e.item.pictures.forEach(function(t){i.push(e.storage.child(t.path).delete().catch(function(t){return n(t)}))},e),o.a.all(i).then(t)}).catch(function(t){console.log("image delete",t)});case 6:return t.next=8,d["a"].collection("items").doc(this.slug(this.oldItem.name)).delete().catch(function(t){console.log("item delete error",t)});case 8:v()("Item deleted.",{icon:"success"}).then(function(){e.$router.push("/")});case 9:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}(),onPictureChange:function(){var t=this;Object(a["a"])(this.$refs.inputPicture.files).forEach(function(e){var n={file:e},i=new FileReader;i.addEventListener("load",function(){n.src=i.result,t.newItem.pictures.push(n),t.picsToUpload.push(n)},!1),i.readAsDataURL(e)})},cancel:function(){this.$router.push("/i/"+this.slug(this.item.name))},updateItemPath:function(){var t=this;return new o.a(function(e,n){var i=d["a"].collection("items").doc(t.slug(t.newItem.name));i.get().then(function(r){if(r.exists)return n(!1);t.ref.delete().then(function(){return e(i)}).catch(function(t){return console.log("item delete error",t),n(!1)})})})}}},b=g,w=n("2877"),y=Object(w["a"])(b,i,r,!1,null,null,null);e["default"]=y.exports},"549b":function(t,e,n){"use strict";var i=n("d864"),r=n("63b6"),a=n("241e"),s=n("b0dc"),o=n("3702"),c=n("b447"),u=n("20fd"),l=n("7cd6");r(r.S+r.F*!n("4ee1")(function(t){Array.from(t)}),"Array",{from:function(t){var e,n,r,f,p=a(t),d="function"==typeof this?this:Array,h=arguments.length,m=h>1?arguments[1]:void 0,v=void 0!==m,g=0,b=l(p);if(v&&(m=i(m,h>2?arguments[2]:void 0,2)),void 0==b||d==Array&&o(b))for(e=c(p.length),n=new d(e);e>g;g++)u(n,g,v?m(p[g],g):p[g]);else for(f=b.call(p),n=new d;!(r=f.next()).done;g++)u(n,g,v?s(f,m,[r.value,g],!0):r.value);return n.length=g,n}})},"54a1":function(t,e,n){n("6c1c"),n("1654"),t.exports=n("95d5")},"5dbc":function(t,e,n){var i=n("d3f4"),r=n("8b97").set;t.exports=function(t,e,n){var a,s=e.constructor;return s!==n&&"function"==typeof s&&(a=s.prototype)!==n.prototype&&i(a)&&r&&r(t,a),t}},"75fc":function(t,e,n){"use strict";var i=n("a745"),r=n.n(i);function a(t){if(r()(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}var s=n("774e"),o=n.n(s),c=n("c8bb"),u=n.n(c);function l(t){if(u()(Object(t))||"[object Arguments]"===Object.prototype.toString.call(t))return o()(t)}function f(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function p(t){return a(t)||l(t)||f()}n.d(e,"a",function(){return p})},"774e":function(t,e,n){t.exports=n("d2d5")},"8b97":function(t,e,n){var i=n("d3f4"),r=n("cb7c"),a=function(t,e){if(r(t),!i(e)&&null!==e)throw TypeError(e+": can't set as prototype!")};t.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(t,e,i){try{i=n("9b43")(Function.call,n("11e9").f(Object.prototype,"__proto__").set,2),i(t,[]),e=!(t instanceof Array)}catch(r){e=!0}return function(t,n){return a(t,n),e?t.__proto__=n:i(t,n),t}}({},!1):void 0),check:a}},9003:function(t,e,n){var i=n("6b4c");t.exports=Array.isArray||function(t){return"Array"==i(t)}},"95d5":function(t,e,n){var i=n("40c3"),r=n("5168")("iterator"),a=n("481b");t.exports=n("584a").isIterable=function(t){var e=Object(t);return void 0!==e[r]||"@@iterator"in e||a.hasOwnProperty(i(e))}},a745:function(t,e,n){t.exports=n("f410")},c8bb:function(t,e,n){t.exports=n("54a1")},d2d5:function(t,e,n){n("1654"),n("549b"),t.exports=n("584a").Array.from},f410:function(t,e,n){n("1af6"),t.exports=n("584a").Array.isArray}}]);
//# sourceMappingURL=chunk-77d709c4.ecfe5547.js.map